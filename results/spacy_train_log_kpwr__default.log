(pnauk) jedrz@jj-win:~/_WSL_Docs/crf-span-clf$ python -m spacy train ./config/spacy/pl_spancat_acc_gpu.cfg --output ./data/models/pl_spancat_acc_kpwr --paths.train $_KPWR_DIR/kpwr_spancat_train.spacy --paths.dev $_KPWR_DIR/kpwr_spancat_val.spacy --gpu-id 0 --verbose
[2023-04-23 20:53:37,310] [DEBUG] Config overrides from CLI: ['paths.train', 'paths.dev']
✔ Created output directory: data/models/pl_spancat_acc_kpwr
ℹ Saving to output directory: data/models/pl_spancat_acc_kpwr
ℹ Using GPU: 0

=========================== Initializing pipeline ===========================
[2023-04-23 20:53:38,441] [INFO] Set up nlp object from config
[2023-04-23 20:53:38,447] [DEBUG] Loading corpus from path: data/spacy_kpwr/kpwr_spancat_val.spacy
[2023-04-23 20:53:38,448] [DEBUG] Loading corpus from path: data/spacy_kpwr/kpwr_spancat_train.spacy
[2023-04-23 20:53:38,449] [INFO] Pipeline: ['transformer', 'spancat']
[2023-04-23 20:53:38,450] [INFO] Created vocabulary
[2023-04-23 20:53:38,451] [INFO] Finished initializing nlp object
Some weights of the model checkpoint at dkleczek/bert-base-polish-cased-v1 were not used when initializing BertModel: ['cls.seq_relationship.weight', 'cls.predictions.decoder.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.bias', 'cls.predictions.decoder.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.seq_relationship.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.LayerNorm.bias']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializinga BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
[2023-04-23 20:53:50,153] [INFO] Initialized pipeline components: ['transformer', 'spancat']
✔ Initialized pipeline

============================= Training pipeline =============================
[2023-04-23 20:53:50,160] [DEBUG] Loading corpus from path: data/spacy_kpwr/kpwr_spancat_val.spacy
[2023-04-23 20:53:50,161] [DEBUG] Loading corpus from path: data/spacy_kpwr/kpwr_spancat_train.spacy
ℹ Pipeline: ['transformer', 'spancat']
ℹ Initial learn rate: 0.0
E    #       LOSS TRANS...  LOSS SPANCAT  SPANS_SC_F  SPANS_SC_P  SPANS_SC_R  SCORE
---  ------  -------------  ------------  ----------  ----------  ----------  ------
  0       0        3665.84      17235.95        0.05        0.02       45.31    0.00
  0     200      450094.93    4438093.27        0.00        0.00        0.00    0.00
  1     400        1685.56     770078.78        0.00        0.00        0.00    0.00
  2     600          43.66      85397.21        0.00        0.00        0.00    0.00
  3     800           0.44      15700.13        0.00        0.00        0.00    0.00
  4    1000           0.02      11147.47        0.00        0.00        0.00    0.00
  5    1200         566.65      11938.20        6.85       48.55        3.68    0.07
  6    1400          11.72      10498.07       22.05       75.97       12.89    0.22
  7    1600           6.72       9529.54       22.10       80.66       12.81    0.22
  8    1800           9.09       9247.17       32.08       66.07       21.18    0.32
  9    2000          11.45       8124.16       38.23       78.98       25.22    0.38
 10    2200           7.68       8025.70       41.02       81.09       27.46    0.41
 11    2400           5.60       7468.42       39.89       84.64       26.10    0.40
 12    2600           6.67       7224.92       41.87       83.91       27.89    0.42
 13    2800           9.45       6930.26       47.30       75.55       34.43    0.47
 14    3000          14.01       6433.35       51.64       76.62       38.95    0.52
 15    3200          18.22       5878.66       52.13       75.58       39.78    0.52
 16    3400          18.04       5394.83       53.82       80.97       40.31    0.54
 17    3600          13.12       5061.14       54.84       79.87       41.75    0.55
 18    3800          10.21       4796.58       55.62       76.14       43.82    0.56
 19    4000          10.79       4248.92       57.41       80.52       44.61    0.57
 20    4200           9.84       4462.98       57.46       75.55       46.36    0.57
 21    4400           8.74       4183.61       58.35       74.12       48.11    0.58
 22    4600           9.43       4055.53       58.11       78.09       46.27    0.58
 23    4800          12.00       3861.62       59.11       74.60       48.95    0.59
 23    5000           9.06       3641.71       58.61       80.86       45.96    0.59
 24    5200           7.71       3440.30       59.41       80.56       47.06    0.59
 25    5400           7.77       3382.59       60.32       78.59       48.95    0.60
 26    5600           7.57       3195.65       62.66       73.75       54.47    0.63
 27    5800          10.49       2851.10       63.76       76.86       54.47    0.64
 28    6000           8.96       2742.73       65.30       80.15       55.09    0.65
 29    6200           8.44       2482.18       63.84       73.99       56.14    0.64
 30    6400           7.75       2578.03       63.26       78.09       53.16    0.63
 31    6600           5.64       2367.26       64.14       77.09       54.91    0.64
 32    6800           5.26       2319.21       63.93       74.39       56.05    0.64
 33    7000           4.32       2133.23       64.14       75.82       55.57    0.64
 34    7200           3.33       2217.20       63.79       76.34       54.78    0.64
 35    7400           3.56       2120.72       64.34       74.50       56.62    0.64
 36    7600           2.34       2109.29       64.63       79.82       54.30    0.65
✔ Saved pipeline to output directory
data/models/pl_spancat_acc_kpwr/model-last
(pnauk) jedrz@jj-win:~/_WSL_Docs/crf-span-clf$
